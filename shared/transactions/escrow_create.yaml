components:
  schemas:
    EscrowCreateTransaction:
      $id: EscrowCreateTransaction
      allOf:
        - $ref: '../base.yaml#/components/schemas/BaseTransaction'
      type: object
      description: |
        Sequester XRP until the escrow process either finishes or is canceled.
      required:
        - Amount
        - Destination
      properties:
        Amount:
          description: |
            The amount to deduct from the sender's balance and and set aside in escrow. 
            Once escrowed, this amount can either go to the Destination address (after any Finish times/conditions) 
            or returned to the sender (after any cancellation times/conditions). 
            Can represent XRP in drops, an IOU token, or MPT. Must always be a positive value.
          oneOf:
            - type: string
              description: 'The amount of XRP (drops), represented as a string.'
              x-custom-validation:
                isNumericString: true
            - $ref: '../base.yaml#/components/schemas/TokenAmount'
        Destination:
          type: string
          description: |
            Address to receive escrowed XRP.
        CancelAfter:
          type: integer
          format: uint32
          description: |
            (Optional) The time, in seconds since the Ripple Epoch, when this escrow expires. This value is
            immutable; the funds can only be returned to the sender after this time.
        FinishAfter:
          type: integer
          format: uint32
          description: |
            (Optional) The time, in seconds since the Ripple Epoch, when the escrowed XRP can be released to
            the recipient. This value is immutable, and the funds can't be accessed until this time.
        Condition:
          type: string
          description: |
            (Optional) Hex value representing a PREIMAGE-SHA-256 crypto-condition. The funds can only be
            delivered to the recipient if this condition is fulfilled. If the condition is not fulfilled
            before the expiration time specified in the CancelAfter field, the XRP can only revert to the sender.
        DestinationTag:
          type: integer
          format: uint32
          description: |
            (Optional) Arbitrary tag to further specify the destination for this escrowed payment, such as a
            hosted recipient at the destination address.
      x-custom-validation:
        requireFieldComparison:
          - smallerField: FinishAfter
            largerField: CancelAfter

    EscrowCreateErrorCode:
      $id: LedgerStateFixErrorCode
      type: integer
      format: uint32
      description: Error codes for the LedgerStateFix transaction.
      enum:
        - 139
        - 134
        - 129
        - 160
        - 137
      x-enum-varnames:
        - tecNO_PERMISSION
        - tecNO_AUTH
        - tecUNFUNDED
        - tecOBJECT_NOT_FOUND
        - tecFROZEN
      x-enum-descriptions:
        - If the source account is the issuer of the token, the transaction fails with tecNO_PERMISSION.
        - If the issuer requires authorization and the source is not authorized, the transaction fails with tecNO_AUTH.
        - 'IOU Tokens: If the source lacks a trustline with the issuer, the transaction fails with tecUNFUNDED .'
        - 'MPTs: If the source does not hold the MPT, the transaction fails with tecOBJECT_NOT_FOUND.'
        - If the token is frozen (global/individual/deepfreeze) (IOU) or locked (MPT) for the source, the transaction fails with tecFROZEN.
